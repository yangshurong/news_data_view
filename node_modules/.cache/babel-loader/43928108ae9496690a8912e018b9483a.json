{"ast":null,"code":"import \"core-js/modules/es.array.find-index.js\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport dayjs from 'dayjs';\nimport VueSlider from 'vue-slider-component';\nimport 'vue-slider-component/theme/antd.css';\nimport Bus from \"@/Common/Commonjs/bus.js\";\nimport { removeNCPrimitives } from '@/Common/Tools/DrawPloyglonNC';\nexport default {\n  name: 'TimeSlider',\n  components: {\n    VueSlider: VueSlider\n  },\n  data: function data() {\n    var _this = this;\n\n    return {\n      marksFun: function marksFun(v) {\n        return _this.showMarkStyle(v);\n      },\n      playType: false,\n      sliderData: [],\n      sliderValue: '',\n      sliderNumber: 0,\n      formatter2: function formatter2(v) {\n        return dayjs(v, 'YYYY-MM-DD 00:00').format('D日 HH:00');\n      },\n      timeInterval: 2 * 1000,\n      timer: null\n    };\n  },\n  created: function created() {\n    //取预报两天历史一天 就当天数据\n    this.sliderValue = dayjs().format('YYYY-MM-DD HH:00');\n    var startTime = dayjs().subtract(1, 'day').format('YYYY-MM-DD 00:00');\n\n    for (var i = 0; i < 24 * 4 + 1; i++) {\n      var time = dayjs(startTime, 'YYYY-MM-DD HH:00').add(i, 'hour').format('YYYY-MM-DD HH:00');\n      this.sliderData.push(time);\n\n      if (time == this.sliderValue) {\n        this.sliderNumber = i;\n      }\n    }\n  },\n  mounted: function mounted() {\n    console.log(this.$refs.slider);\n  },\n  methods: {\n    showMarkStyle: function showMarkStyle(v) {\n      if (dayjs(v, 'YYYY-MM-DD 00:00').format('H') % 3 == 0) {\n        if (dayjs(v, 'YYYY-MM-DD 00:00').format('HH') == '00') {\n          if (v == this.sliderData[this.sliderData.length - 1]) {\n            return {\n              label: dayjs(v, 'YYYY-MM-DD 00:00').format('D日'),\n              labelStyle: {\n                display: 'none'\n              },\n              style: {\n                height: '60px',\n                position: 'relative',\n                top: '-30px'\n              }\n            };\n          } else {\n            return {\n              label: dayjs(v, 'YYYY-MM-DD 00:00').format('D日'),\n              labelStyle: {\n                //display: 'none'\n                position: 'relative',\n                top: '-95px',\n                left: '10px',\n                color: '#E9E9E9',\n                fontSize: '14px',\n                fontWeight: 'bold'\n              },\n              style: {\n                height: '60px',\n                position: 'relative',\n                top: '-30px'\n              }\n            };\n          }\n        } else {\n          return {\n            label: dayjs(v, 'YYYY-MM-DD 00:00').format('HH'),\n            style: {\n              height: '12px',\n              position: 'relative',\n              top: '100%'\n            },\n            labelActiveStyle: {\n              color: '#8D8D8D'\n            }\n          };\n        }\n      } else {\n        return {\n          style: {\n            height: '8px',\n            position: 'relative',\n            top: '100%'\n          },\n          labelStyle: {\n            display: 'none'\n          }\n        };\n      }\n    },\n    changePlayType: function changePlayType() {\n      console.log(this.playType);\n      this.playType = !this.playType;\n\n      if (this.playType) {\n        this.play();\n      } else {\n        if (this.timer != null) {\n          clearInterval(this.timer);\n          this.timer = null;\n        }\n      }\n    },\n    play: function play() {\n      var _this2 = this;\n\n      this.sliderValue = this.sliderData[++this.sliderNumber];\n      this.timer = setInterval(function () {\n        _this2.sliderValue = _this2.sliderData[++_this2.sliderNumber];\n\n        if (_this2.sliderNumber == _this2.sliderData.length) {\n          _this2.sliderValue = _this2.sliderData[0];\n          clearInterval(_this2.timer);\n        }\n      }, this.timeInterval);\n    }\n  },\n  watch: {\n    //监听时间变化\n    sliderValue: function sliderValue(val) {\n      var index = this.sliderData.findIndex(function (item) {\n        return val == item;\n      });\n      console.log(index);\n      this.sliderNumber = index != -1 ? index : 0;\n\n      if (this.sliderNumber >= 96) {\n        this.playType = false;\n      } // this.sliderNumber >= 96 ? this.playType = false:this.playType = true\n\n\n      Bus.$emit(\"sentChangeTime\", dayjs(val).format('HH'));\n    },\n    sliderNumber: function sliderNumber(val) {\n      console.log(val);\n    }\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;AAiBA;AACA;AACA;AACA;AACA;AACA;AACAA,oBADA;AAEAC;AACAC;AADA,GAFA;AAKAC,MALA,kBAKA;AAAA;;AACA;AACAC;AAAA;AAAA,OADA;AAEAC,qBAFA;AAGAC,oBAHA;AAIAC,qBAJA;AAKAC,qBALA;AAMAC;AAAA;AAAA,OANA;AAOAC,4BAPA;AAQAC;AARA;AAWA,GAjBA;AAkBAC,SAlBA,qBAkBA;AACA;AACA;AACA;;AACA;AACA;AACA;;AACA;AACA;AACA;AACA;AACA,GA7BA;AA8BAC,SA9BA,qBA8BA;AACAC;AAEA,GAjCA;AAkCAC;AACAC,iBADA,yBACAC,CADA,EACA;AACA;AAEA;AACA;AACA;AACAC,8DADA;AAEAC;AACAC;AADA,eAFA;AAKAC;AACAC,8BADA;AAEAC,oCAFA;AAGAC;AAHA;AALA;AAWA,WAZA,MAYA;AACA;AACAN,8DADA;AAEAC;AACA;AACAI,oCAFA;AAGAC,4BAHA;AAIAC,4BAJA;AAKAC,gCALA;AAMAC,gCANA;AAOAC;AAPA,eAFA;AAWAP;AACAC,8BADA;AAEAC,oCAFA;AAGAC;AAHA;AAXA;AAiBA;AAEA,SAjCA,MAiCA;AACA;AACAN,4DADA;AAEAG;AACAC,4BADA;AAEAC,kCAFA;AAGAC;AAHA,aAFA;AAOAK;AACAH;AADA;AAPA;AAWA;AAEA,OAjDA,MAiDA;AACA;AACAL;AACAC,yBADA;AAEAC,gCAFA;AAGAC;AAHA,WADA;AAMAL;AACAC;AADA;AANA;AAUA;AACA,KA/DA;AAgEAU,kBAhEA,4BAgEA;AACAhB;AACA;;AACA;AACA;AACA,OAFA,MAEA;AACA;AACAiB;AACA;AACA;AACA;AACA,KA3EA;AA6EAC,QA7EA,kBA6EA;AAAA;;AAEA;AACA;AACA;;AACA;AACA;AACAD;AACA;AACA,OANA,EAMA,iBANA;AAOA;AAvFA,GAlCA;AA2HAE;AACA;AACA1B,eAFA,uBAEA2B,GAFA,EAEA;AACA;AACA;AACA,OAFA;AAGApB;AACA;;AACA;AACA;AACA,OARA,CASA;;;AACAqB;AACA,KAbA;AAcA3B,gBAdA,wBAcA0B,GAdA,EAcA;AACApB;AACA;AAhBA;AA3HA","names":["name","components","VueSlider","data","marksFun","playType","sliderData","sliderValue","sliderNumber","formatter2","timeInterval","timer","created","mounted","console","methods","showMarkStyle","v","label","labelStyle","display","style","height","position","top","left","color","fontSize","fontWeight","labelActiveStyle","changePlayType","clearInterval","play","watch","val","Bus"],"sourceRoot":"src/components","sources":["main_time.vue"],"sourcesContent":["\r\n<template>\r\n  <div class=\"timeSliderBox\">\r\n    <div class=\"playType\" @click=\"changePlayType\">\r\n      <span :class=\"playType ? 'stopIcon' : 'playIcon'\"></span>\r\n    </div>\r\n    <div class=\"slider\">\r\n      <vue-slider :marks=\"marksFun\" :tooltip-formatter=\"formatter2\" ref=\"slider\" v-model=\"sliderValue\" :data=\"sliderData\" :tooltip=\"'always'\">\r\n        <template v-slot:dot>\r\n          <i class=\"custom-dot\"></i>\r\n        </template>\r\n      </vue-slider>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport dayjs from 'dayjs'\r\nimport VueSlider from 'vue-slider-component'\r\nimport 'vue-slider-component/theme/antd.css'\r\nimport Bus from \"@/Common/Commonjs/bus.js\";\r\nimport { removeNCPrimitives } from '@/Common/Tools/DrawPloyglonNC'\r\nexport default {\r\n  name: 'TimeSlider',\r\n  components: {\r\n    VueSlider\r\n  },\r\n  data () {\r\n    return {\r\n      marksFun: v => this.showMarkStyle(v),\r\n      playType: false,\r\n      sliderData: [],\r\n      sliderValue: '',\r\n      sliderNumber: 0,\r\n      formatter2: v => (dayjs(v, 'YYYY-MM-DD 00:00').format('D日 HH:00')),\r\n      timeInterval: 2 * 1000,\r\n      timer: null,\r\n\r\n    }\r\n  },\r\n  created () {\r\n    //取预报两天历史一天 就当天数据\r\n    this.sliderValue = dayjs().format('YYYY-MM-DD HH:00');\r\n    let startTime = dayjs().subtract(1, 'day').format('YYYY-MM-DD 00:00');\r\n    for (let i = 0; i < 24 * 4 + 1; i++) {\r\n      let time = dayjs(startTime, 'YYYY-MM-DD HH:00').add(i, 'hour').format('YYYY-MM-DD HH:00')\r\n      this.sliderData.push(time)\r\n      if (time == this.sliderValue) {\r\n        this.sliderNumber = i\r\n      }\r\n    }\r\n  },\r\n  mounted(){\r\n    console.log(this.$refs.slider )\r\n   \r\n  },\r\n  methods: {\r\n    showMarkStyle (v) {\r\n      if ((dayjs(v, 'YYYY-MM-DD 00:00').format('H')) % 3 == 0) {\r\n\r\n        if (dayjs(v, 'YYYY-MM-DD 00:00').format('HH') == '00') {\r\n          if (v == this.sliderData[this.sliderData.length - 1]) {\r\n            return {\r\n              label: dayjs(v, 'YYYY-MM-DD 00:00').format('D日'),\r\n              labelStyle: {\r\n                display: 'none'\r\n              },\r\n              style: {\r\n                height: '60px',\r\n                position: 'relative',\r\n                top: '-30px',\r\n              }\r\n            }\r\n          } else {\r\n            return {\r\n              label: dayjs(v, 'YYYY-MM-DD 00:00').format('D日'),\r\n              labelStyle: {\r\n                //display: 'none'\r\n                position: 'relative',\r\n                top: '-95px',\r\n                left: '10px',\r\n                color: '#E9E9E9',\r\n                fontSize: '14px',\r\n                fontWeight: 'bold'\r\n              },\r\n              style: {\r\n                height: '60px',\r\n                position: 'relative',\r\n                top: '-30px',\r\n              }\r\n            }\r\n          }\r\n\r\n        } else {\r\n          return {\r\n            label: dayjs(v, 'YYYY-MM-DD 00:00').format('HH'),\r\n            style: {\r\n              height: '12px',\r\n              position: 'relative',\r\n              top: '100%',\r\n            },\r\n            labelActiveStyle: {\r\n              color: '#8D8D8D'\r\n            }\r\n          }\r\n        }\r\n\r\n      } else {\r\n        return {\r\n          style: {\r\n            height: '8px',\r\n            position: 'relative',\r\n            top: '100%',\r\n          },\r\n          labelStyle: {\r\n            display: 'none'\r\n          },\r\n        }\r\n      }\r\n    },\r\n    changePlayType () {\r\n      console.log(this.playType)\r\n      this.playType = !this.playType;\r\n      if (this.playType) {\r\n        this.play()\r\n      } else {\r\n        if (this.timer != null) {\r\n          clearInterval(this.timer)\r\n          this.timer = null\r\n        }\r\n      }\r\n    },\r\n\r\n    play () {\r\n\r\n       this.sliderValue = this.sliderData[++this.sliderNumber]\r\n      this.timer = setInterval(() => {\r\n        this.sliderValue = this.sliderData[++this.sliderNumber]\r\n        if(this.sliderNumber == this.sliderData.length){\r\n          this.sliderValue = this.sliderData[0]\r\n          clearInterval(this.timer)\r\n        }\r\n      }, this.timeInterval)\r\n    },\r\n  },\r\n  watch:{\r\n    //监听时间变化\r\n    sliderValue(val){\r\n      let index = this.sliderData.findIndex(item =>{\r\n         return  val == item\r\n      })\r\n      console.log(index)\r\n      this.sliderNumber = index!=-1?index:0\r\n      if(this.sliderNumber >= 96){\r\n        this.playType = false\r\n      }\r\n      // this.sliderNumber >= 96 ? this.playType = false:this.playType = true\r\n        Bus.$emit(\"sentChangeTime\",  dayjs(val).format('HH')); \r\n    },\r\n sliderNumber(val){\r\n   console.log(val);\r\n }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang='scss' scoped>\r\n.timeSliderBox {\r\n  user-select: none;\r\n  width: 100vw;\r\n  height: 60px;\r\n  position: absolute;\r\n  bottom: 0px;\r\n  left: 0px;\r\n  display: flex;\r\n  background: rgba(0, 0, 0, 0.75);\r\n  align-items: center;\r\n  .playType {\r\n    height: 60px;\r\n    width: 56px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    cursor: pointer;\r\n    border-right: 1px solid #8e8e8e;\r\n\r\n    \r\n  }\r\n  .slider {\r\n    display: flex;\r\n    align-items: center;\r\n    box-sizing: border-box;\r\n    height: 60px;\r\n    width: calc(100vw - 56px);\r\n    padding: 0 20px;\r\n    ::v-deep.vue-slider-rail {\r\n      height: 8px;\r\n      background: #383838;\r\n      opacity: 0.9;\r\n      border-radius: 0px;\r\n    }\r\n    ::v-deep.vue-slider-process {\r\n      background: #359ffc;\r\n      border-radius: 0px;\r\n    }\r\n    ::v-deep.vue-slider {\r\n      width: 100% !important;\r\n    }\r\n    ::v-deep.custom-dot {\r\n      position: relative;\r\n      top: -3px;\r\n      left: -1px;\r\n      display: inline-block;\r\n      width: 16px;\r\n      height: 16px;\r\n      border: 3px solid #fff;\r\n      background: #3498db;\r\n      border-radius: 20px;\r\n    }\r\n    ::v-deep.vue-slider-dot-tooltip-inner {\r\n      border-color: rgba(53, 159, 252, 0.75);\r\n      background-color: rgba(53, 159, 252, 0.75);\r\n      box-shadow: 0 2px 8px rgb(53 159 252 / 15%);\r\n      border-radius: 2px;\r\n    }\r\n    ::v-deep.vue-slider-mark {\r\n      width: 1px !important;\r\n      height: 8px !important;\r\n    }\r\n    ::v-deep.vue-slider-mark-step {\r\n      box-shadow: none;\r\n      border-radius: 0px;\r\n\r\n      background: #8e8e8e;\r\n    }\r\n    ::v-deep.vue-slider-mark-label {\r\n      color: #8e8e8e;\r\n    }\r\n    ::v-deep.vue-slider-dot-tooltip-inner,\r\n    ::v-deep.vue-slider-dot,\r\n    ::v-deep.vue-slider-process {\r\n      transition-duration: 2s !important;\r\n      transition-property: all !important;\r\n      transition-timing-function: linear !important;\r\n    }\r\n  }\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}