{"ast":null,"code":"import Base from 'claygl/src/core/Base';\nimport retrieve from './retrieve';\n/**\n * @alias module:echarts-gl/util/Roam2DControl\n */\n\nvar Roam2DControl = Base.extend(function () {\n  return {\n    /**\n     * @type {module:zrender~ZRender}\n     */\n    zr: null,\n\n    /**\n     * @type {module:echarts-gl/core/ViewGL}\n     */\n    viewGL: null,\n    minZoom: 0.2,\n    maxZoom: 5,\n    _needsUpdate: false,\n    _dx: 0,\n    _dy: 0,\n    _zoom: 1\n  };\n}, function () {\n  // Each Roam2DControl has it's own handler\n  this._mouseDownHandler = this._mouseDownHandler.bind(this);\n  this._mouseWheelHandler = this._mouseWheelHandler.bind(this);\n  this._mouseMoveHandler = this._mouseMoveHandler.bind(this);\n  this._mouseUpHandler = this._mouseUpHandler.bind(this);\n  this._update = this._update.bind(this);\n}, {\n  init: function init() {\n    var zr = this.zr;\n    zr.on('mousedown', this._mouseDownHandler);\n    zr.on('mousewheel', this._mouseWheelHandler);\n    zr.on('globalout', this._mouseUpHandler);\n    zr.animation.on('frame', this._update);\n  },\n  setTarget: function setTarget(target) {\n    this._target = target;\n  },\n  setZoom: function setZoom(zoom) {\n    this._zoom = Math.max(Math.min(zoom, this.maxZoom), this.minZoom);\n    this._needsUpdate = true;\n  },\n  setOffset: function setOffset(offset) {\n    this._dx = offset[0];\n    this._dy = offset[1];\n    this._needsUpdate = true;\n  },\n  getZoom: function getZoom() {\n    return this._zoom;\n  },\n  getOffset: function getOffset() {\n    return [this._dx, this._dy];\n  },\n  _update: function _update() {\n    if (!this._target) {\n      return;\n    }\n\n    if (!this._needsUpdate) {\n      return;\n    }\n\n    var target = this._target;\n    var scale = this._zoom;\n    target.position.x = this._dx;\n    target.position.y = this._dy;\n    target.scale.set(scale, scale, scale);\n    this.zr.refresh();\n    this._needsUpdate = false;\n    this.trigger('update');\n  },\n  _mouseDownHandler: function _mouseDownHandler(e) {\n    if (e.target) {\n      return;\n    }\n\n    var x = e.offsetX;\n    var y = e.offsetY;\n\n    if (this.viewGL && !this.viewGL.containPoint(x, y)) {\n      return;\n    }\n\n    this.zr.on('mousemove', this._mouseMoveHandler);\n    this.zr.on('mouseup', this._mouseUpHandler);\n\n    var pos = this._convertPos(x, y);\n\n    this._x = pos.x;\n    this._y = pos.y;\n  },\n  // Convert pos from screen space to viewspace.\n  _convertPos: function _convertPos(x, y) {\n    var camera = this.viewGL.camera;\n    var viewport = this.viewGL.viewport; // PENDING\n\n    return {\n      x: (x - viewport.x) / viewport.width * (camera.right - camera.left) + camera.left,\n      y: (y - viewport.y) / viewport.height * (camera.bottom - camera.top) + camera.top\n    };\n  },\n  _mouseMoveHandler: function _mouseMoveHandler(e) {\n    var pos = this._convertPos(e.offsetX, e.offsetY);\n\n    this._dx += pos.x - this._x;\n    this._dy += pos.y - this._y;\n    this._x = pos.x;\n    this._y = pos.y;\n    this._needsUpdate = true;\n  },\n  _mouseUpHandler: function _mouseUpHandler(e) {\n    this.zr.off('mousemove', this._mouseMoveHandler);\n    this.zr.off('mouseup', this._mouseUpHandler);\n  },\n  _mouseWheelHandler: function _mouseWheelHandler(e) {\n    e = e.event;\n    var delta = e.wheelDelta // Webkit\n    || -e.detail; // Firefox\n\n    if (delta === 0) {\n      return;\n    }\n\n    var x = e.offsetX;\n    var y = e.offsetY;\n\n    if (this.viewGL && !this.viewGL.containPoint(x, y)) {\n      return;\n    }\n\n    var zoomScale = delta > 0 ? 1.1 : 0.9;\n    var newZoom = Math.max(Math.min(this._zoom * zoomScale, this.maxZoom), this.minZoom);\n    zoomScale = newZoom / this._zoom;\n\n    var pos = this._convertPos(x, y);\n\n    var fixX = (pos.x - this._dx) * (zoomScale - 1);\n    var fixY = (pos.y - this._dy) * (zoomScale - 1);\n    this._dx -= fixX;\n    this._dy -= fixY;\n    this._zoom = newZoom;\n    this._needsUpdate = true;\n  },\n  dispose: function dispose() {\n    var zr = this.zr;\n    zr.off('mousedown', this._mouseDownHandler);\n    zr.off('mousemove', this._mouseMoveHandler);\n    zr.off('mouseup', this._mouseUpHandler);\n    zr.off('mousewheel', this._mouseWheelHandler);\n    zr.off('globalout', this._mouseUpHandler);\n    zr.animation.off('frame', this._update);\n  }\n});\nexport default Roam2DControl;","map":{"version":3,"sources":["C:/Users/Administrator/Desktop/data_view/my_project/vue2_app/myapp/node_modules/_echarts-gl@2.0.9@echarts-gl/lib/util/Roam2DControl.js"],"names":["Base","retrieve","Roam2DControl","extend","zr","viewGL","minZoom","maxZoom","_needsUpdate","_dx","_dy","_zoom","_mouseDownHandler","bind","_mouseWheelHandler","_mouseMoveHandler","_mouseUpHandler","_update","init","on","animation","setTarget","target","_target","setZoom","zoom","Math","max","min","setOffset","offset","getZoom","getOffset","scale","position","x","y","set","refresh","trigger","e","offsetX","offsetY","containPoint","pos","_convertPos","_x","_y","camera","viewport","width","right","left","height","bottom","top","off","event","delta","wheelDelta","detail","zoomScale","newZoom","fixX","fixY","dispose"],"mappings":"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","sourcesContent":["import Base from 'claygl/src/core/Base';\nimport retrieve from './retrieve';\n/**\n * @alias module:echarts-gl/util/Roam2DControl\n */\n\nvar Roam2DControl = Base.extend(function () {\n  return {\n    /**\n     * @type {module:zrender~ZRender}\n     */\n    zr: null,\n\n    /**\n     * @type {module:echarts-gl/core/ViewGL}\n     */\n    viewGL: null,\n    minZoom: 0.2,\n    maxZoom: 5,\n    _needsUpdate: false,\n    _dx: 0,\n    _dy: 0,\n    _zoom: 1\n  };\n}, function () {\n  // Each Roam2DControl has it's own handler\n  this._mouseDownHandler = this._mouseDownHandler.bind(this);\n  this._mouseWheelHandler = this._mouseWheelHandler.bind(this);\n  this._mouseMoveHandler = this._mouseMoveHandler.bind(this);\n  this._mouseUpHandler = this._mouseUpHandler.bind(this);\n  this._update = this._update.bind(this);\n}, {\n  init: function () {\n    var zr = this.zr;\n    zr.on('mousedown', this._mouseDownHandler);\n    zr.on('mousewheel', this._mouseWheelHandler);\n    zr.on('globalout', this._mouseUpHandler);\n    zr.animation.on('frame', this._update);\n  },\n  setTarget: function (target) {\n    this._target = target;\n  },\n  setZoom: function (zoom) {\n    this._zoom = Math.max(Math.min(zoom, this.maxZoom), this.minZoom);\n    this._needsUpdate = true;\n  },\n  setOffset: function (offset) {\n    this._dx = offset[0];\n    this._dy = offset[1];\n    this._needsUpdate = true;\n  },\n  getZoom: function () {\n    return this._zoom;\n  },\n  getOffset: function () {\n    return [this._dx, this._dy];\n  },\n  _update: function () {\n    if (!this._target) {\n      return;\n    }\n\n    if (!this._needsUpdate) {\n      return;\n    }\n\n    var target = this._target;\n    var scale = this._zoom;\n    target.position.x = this._dx;\n    target.position.y = this._dy;\n    target.scale.set(scale, scale, scale);\n    this.zr.refresh();\n    this._needsUpdate = false;\n    this.trigger('update');\n  },\n  _mouseDownHandler: function (e) {\n    if (e.target) {\n      return;\n    }\n\n    var x = e.offsetX;\n    var y = e.offsetY;\n\n    if (this.viewGL && !this.viewGL.containPoint(x, y)) {\n      return;\n    }\n\n    this.zr.on('mousemove', this._mouseMoveHandler);\n    this.zr.on('mouseup', this._mouseUpHandler);\n\n    var pos = this._convertPos(x, y);\n\n    this._x = pos.x;\n    this._y = pos.y;\n  },\n  // Convert pos from screen space to viewspace.\n  _convertPos: function (x, y) {\n    var camera = this.viewGL.camera;\n    var viewport = this.viewGL.viewport; // PENDING\n\n    return {\n      x: (x - viewport.x) / viewport.width * (camera.right - camera.left) + camera.left,\n      y: (y - viewport.y) / viewport.height * (camera.bottom - camera.top) + camera.top\n    };\n  },\n  _mouseMoveHandler: function (e) {\n    var pos = this._convertPos(e.offsetX, e.offsetY);\n\n    this._dx += pos.x - this._x;\n    this._dy += pos.y - this._y;\n    this._x = pos.x;\n    this._y = pos.y;\n    this._needsUpdate = true;\n  },\n  _mouseUpHandler: function (e) {\n    this.zr.off('mousemove', this._mouseMoveHandler);\n    this.zr.off('mouseup', this._mouseUpHandler);\n  },\n  _mouseWheelHandler: function (e) {\n    e = e.event;\n    var delta = e.wheelDelta // Webkit\n    || -e.detail; // Firefox\n\n    if (delta === 0) {\n      return;\n    }\n\n    var x = e.offsetX;\n    var y = e.offsetY;\n\n    if (this.viewGL && !this.viewGL.containPoint(x, y)) {\n      return;\n    }\n\n    var zoomScale = delta > 0 ? 1.1 : 0.9;\n    var newZoom = Math.max(Math.min(this._zoom * zoomScale, this.maxZoom), this.minZoom);\n    zoomScale = newZoom / this._zoom;\n\n    var pos = this._convertPos(x, y);\n\n    var fixX = (pos.x - this._dx) * (zoomScale - 1);\n    var fixY = (pos.y - this._dy) * (zoomScale - 1);\n    this._dx -= fixX;\n    this._dy -= fixY;\n    this._zoom = newZoom;\n    this._needsUpdate = true;\n  },\n  dispose: function () {\n    var zr = this.zr;\n    zr.off('mousedown', this._mouseDownHandler);\n    zr.off('mousemove', this._mouseMoveHandler);\n    zr.off('mouseup', this._mouseUpHandler);\n    zr.off('mousewheel', this._mouseWheelHandler);\n    zr.off('globalout', this._mouseUpHandler);\n    zr.animation.off('frame', this._update);\n  }\n});\nexport default Roam2DControl;"]},"metadata":{},"sourceType":"module"}